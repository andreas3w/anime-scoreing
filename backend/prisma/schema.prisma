// Prisma schema for Anime List Manager

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Anime {
  id                Int       @id @default(autoincrement())
  malId             Int       @unique
  title             String
  type              String?
  episodes          Int?
  myScore           Int       @default(0)
  myWatchedEpisodes Int       @default(0)
  myStartDate       DateTime?
  myFinishDate      DateTime?
  myRewatching      Boolean   @default(false)
  myRewatchingEp    Int       @default(0)
  myLastUpdated     DateTime  @default(now())
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt

  // Relations
  tags AnimeTag[]
}

model Tag {
  id       Int     @id @default(autoincrement())
  name     String  @unique
  color    String
  isStatus Boolean @default(false)

  // Relations
  animes AnimeTag[]
}

model AnimeTag {
  anime   Anime @relation(fields: [animeId], references: [id], onDelete: Cascade)
  animeId Int
  tag     Tag   @relation(fields: [tagId], references: [id], onDelete: Cascade)
  tagId   Int

  @@id([animeId, tagId])
}
