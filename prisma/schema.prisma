generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Note: SQLite doesn't support enums, so colorKey is stored as String
// Valid values defined in src/lib/prisma.ts as ColorKey type

model Anime {
  id                 Int        @id @default(autoincrement())
  malId              Int        @unique
  title              String
  titleEnglish       String?
  titleJapanese      String?
  imageUrl           String?
  synopsis           String?
  trailerUrl         String?
  year               Int?
  dataFetched        Boolean    @default(false)
  type               String?
  episodes           Int?
  myScore            Int        @default(0)
  myStatus           String?
  myWatchedEpisodes  Int        @default(0)
  myStartDate        String?
  myFinishDate       String?
  myLastUpdated      String?
  tags               AnimeTag[]
  createdAt          DateTime   @default(now())
  updatedAt          DateTime   @updatedAt
}

model Tag {
  id       Int        @id @default(autoincrement())
  name     String     @unique
  colorKey String     @default("DEFAULT")
  isStatus Boolean    @default(false)
  isType   Boolean    @default(false)
  isStudio Boolean    @default(false)
  isGenre  Boolean    @default(false)
  anime    AnimeTag[]
}

model AnimeTag {
  animeId Int
  tagId   Int
  anime   Anime @relation(fields: [animeId], references: [id], onDelete: Cascade)
  tag     Tag   @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([animeId, tagId])
}
